% [Ef] = gausshq(f)
%
% Compute E[f(Z)] for standard normal Z using order 20 Gauss-Hermite
% quadrature.
%
function [Ef] = gausshq(f)

  gh_nodes_weights = [...
      -5.387480890011232862017  2.22939364553415129252E-13
      -4.603682449550744273078  4.3993409922731805536E-10
      -3.944764040115625210376  1.086069370769281694E-7
      -3.347854567383216326915  7.80255647853206369415E-6
      -2.78880605842813048053	2.28338636016353967257E-4
      -2.254974002089275523082	0.00324377334223786183218
      -1.738537712116586206781	0.0248105208874636108822
      -1.234076215395323007886	0.1090172060200233200138
      -0.7374737285453943587056	0.2866755053628341297197
      -0.2453407083009012499038	0.46224366960061008965
       0.2453407083009012499038	0.46224366960061008965
       0.7374737285453943587056	0.28667550536283412972
       1.234076215395323007886  0.1090172060200233200138
       1.738537712116586206781  0.0248105208874636108822
       2.254974002089275523082  0.00324377334223786183218
       2.78880605842813048053   2.283386360163539672572E-4
       3.347854567383216326915  7.8025564785320636941E-6
       3.944764040115625210376  1.086069370769281694E-7
       4.603682449550744273078  4.39934099227318055363E-10
       5.387480890011232862017  2.22939364553415129252E-13];
  x = gh_nodes_weights(:,1) * sqrt(2);
  w = gh_nodes_weights(:,2) / sqrt(pi);
  Ef = w' * f(x);
